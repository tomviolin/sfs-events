{"version":3,"sources":["@photo-sphere-viewer/core","leaflet","three","src/index.ts","src/events.ts","src/PlanPlugin.ts","src/components/PlanComponent.ts","src/constants.ts","src/utils.ts","src/components/PlanCloseButton.ts","src/icons/map.svg","src/components/AbstractPlanButton.ts","src/icons/layers.svg","src/components/PlanLayersButton.ts","src/icons/maximize.svg","src/icons/minimize.svg","src/components/PlanMaximizeButton.ts","src/icons/reset.svg","src/components/PlanResetButton.ts","src/icons/pin.svg"],"sourcesContent":["module.exports = PhotoSphereViewer","module.exports = L","module.exports = THREE","import { DEFAULTS } from '@photo-sphere-viewer/core';\nimport * as events from './events';\n\nDEFAULTS.lang['map'] = 'Map';\nDEFAULTS.lang['mapMaximize'] = 'Maximize';\nDEFAULTS.lang['mapMinimize'] = 'Minimize';\nDEFAULTS.lang['mapReset'] = 'Reset';\nDEFAULTS.lang['mapLayers'] = 'Base layer';\n\nexport { PlanPlugin } from './PlanPlugin';\nexport * from './model';\nexport { events };\n\n/** @internal  */\nimport './style.scss';\n","import { TypedEvent } from '@photo-sphere-viewer/core';\nimport type { PlanPlugin } from './PlanPlugin';\n\n/**\n * @event Triggered when the user clicks on a hotspot\n */\nexport class SelectHotspot extends TypedEvent<PlanPlugin> {\n    static override readonly type = 'select-hotspot';\n    override type: 'select-hotspot';\n\n    /** @internal */\n    constructor(public readonly hotspotId: string) {\n        super(SelectHotspot.type);\n    }\n}\n\nexport type PlanPluginEvents = SelectHotspot;\n","import { AbstractConfigurablePlugin, events, utils, type Viewer } from '@photo-sphere-viewer/core';\nimport type { Marker, events as markersEvents, MarkersPlugin } from '@photo-sphere-viewer/markers-plugin';\nimport { type Map } from 'leaflet';\nimport { PlanComponent } from './components/PlanComponent';\nimport { HOTSPOT_GENERATED_ID, HOTSPOT_MARKER_ID, MARKER_DATA_KEY, OSM_ATTRIBUTION, OSM_LABEL, OSM_URL } from './constants';\nimport { PlanPluginEvents } from './events';\nimport pin from './icons/pin.svg';\nimport { GpsPosition, ParsedPlanPluginConfig, PlanHotspot, PlanPluginConfig, UpdatablePlanPluginConfig } from './model';\n\nconst getConfig = utils.getConfigParser<PlanPluginConfig>(\n    {\n        coordinates: null,\n        bearing: 0,\n        size: { width: '300px', height: '200px' },\n        position: ['bottom', 'left'],\n        visibleOnLoad: true,\n        pinImage: pin,\n        pinSize: 35,\n        spotStyle: {\n            size: 15,\n            image: null,\n            color: 'white',\n            hoverSize: null,\n            hoverImage: null,\n            hoverColor: null,\n            hoverBorderSize: 4,\n            hoverBorderColor: 'rgba(255, 255, 255, 0.8)',\n        },\n        defaultZoom: 15,\n        layers: [{\n            urlTemplate: OSM_URL,\n            attribution: OSM_ATTRIBUTION,\n            name: OSM_LABEL,\n        }],\n        configureLeaflet: null,\n        hotspots: [],\n        buttons: {\n            maximize: true,\n            close: true,\n            reset: true,\n        },\n    },\n    {\n        spotStyle: (spotStyle, { defValue }) => ({ ...defValue, ...spotStyle }),\n        position: (position, { defValue }) => {\n            return utils.cleanCssPosition(position, { allowCenter: false, cssOrder: true }) || defValue;\n        },\n        bearing: (bearing) => utils.parseAngle(bearing),\n        buttons: (buttons, { defValue }) => ({ ...defValue, ...buttons }),\n    }\n);\n\n/**\n * Adds a map on the viewer\n */\nexport class PlanPlugin extends AbstractConfigurablePlugin<\n    PlanPluginConfig,\n    ParsedPlanPluginConfig,\n    UpdatablePlanPluginConfig,\n    PlanPluginEvents\n> {\n    static override readonly id = 'plan';\n    static override readonly VERSION = PKG_VERSION;\n    static override readonly configParser = getConfig;\n    static override readonly readonlyOptions: Array<keyof PlanPluginConfig> = [\n        'visibleOnLoad',\n        'defaultZoom',\n        'layers',\n        'configureLeaflet',\n        'buttons',\n    ];\n\n    private markers?: MarkersPlugin;\n    readonly component: PlanComponent;\n\n    constructor(viewer: Viewer, config: PlanPluginConfig) {\n        super(viewer, config);\n\n        this.component = new PlanComponent(this.viewer, this);\n    }\n\n    /**\n     * @internal\n     */\n    override init() {\n        super.init();\n\n        utils.checkStylesheet(this.viewer.container, 'plan-plugin');\n\n        this.markers = this.viewer.getPlugin('markers');\n\n        this.viewer.addEventListener(events.PositionUpdatedEvent.type, this);\n        this.viewer.addEventListener(events.ReadyEvent.type, this, { once: true });\n        this.markers?.addEventListener('set-markers', this);\n\n        this.setHotspots(this.config.hotspots);\n    }\n\n    /**\n     * @internal\n     */\n    override destroy() {\n        this.viewer.removeEventListener(events.PositionUpdatedEvent.type, this);\n        this.viewer.removeEventListener(events.ReadyEvent.type, this);\n        this.markers?.removeEventListener('set-markers', this);\n\n        this.component.destroy();\n\n        super.destroy();\n    }\n\n    /**\n     * @internal\n     */\n    handleEvent(e: Event) {\n        switch (e.type) {\n            case events.ReadyEvent.type:\n                this.component.show();\n                break;\n            case events.PositionUpdatedEvent.type:\n                this.component.updateBearing((e as events.PositionUpdatedEvent).position);\n                break;\n            case 'set-markers':\n                this.component.setMarkers(this.__markersToHotspots((e as markersEvents.SetMarkersEvent).markers));\n                break;\n            default:\n                break;\n        }\n    }\n\n    override setOptions(options: Partial<PlanPluginConfig>) {\n        super.setOptions(options);\n\n        if (options.coordinates) {\n            this.component.recenter();\n        }\n        if (!utils.isNil(options.bearing)) {\n            this.component.updateBearing();\n        }\n        if (options.pinImage || options.pinSize) {\n            this.component.updatePin();\n        }\n        if (options.spotStyle) {\n            this.component.updateSpots();\n        }\n        if (options.hotspots !== undefined) {\n            this.setHotspots(options.hotspots);\n        }\n\n        this.component.applyConfig();\n    }\n\n    /**\n     * Hides the map\n     */\n    hide() {\n        this.component.hide();\n    }\n\n    /**\n     * Shows the map\n     */\n    show() {\n        this.component.show();\n    }\n\n    /**\n     * Closes the map\n     */\n    close() {\n        if (!this.component.collapsed) {\n            this.component.toggleCollapse();\n        }\n    }\n\n    /**\n     * Open the map\n     */\n    open() {\n        if (this.component.collapsed) {\n            this.component.toggleCollapse();\n        }\n    }\n\n    /**\n     * Minimizes the map\n     */\n    minimize() {\n        if (this.component.maximized) {\n            this.component.toggleMaximized();\n        }\n    }\n\n    /**\n     * Maximizes the map\n     */\n    maximize() {\n        if (!this.component.maximized) {\n            this.component.toggleMaximized();\n        }\n    }\n\n    /**\n     * Changes the position on the map\n     */\n    setCoordinates(coordinates: GpsPosition) {\n        this.config.coordinates = coordinates;\n        this.component.recenter();\n    }\n\n    /**\n     * Changes the hotspots on the map\n     */\n    setHotspots(hotspots: PlanHotspot[]) {\n        const ids: string[] = [];\n        let i = 1;\n\n        hotspots?.forEach((hotspot) => {\n            if (!hotspot.id) {\n                hotspot.id = HOTSPOT_GENERATED_ID + i++;\n            } else if (ids.includes(hotspot.id)) {\n                utils.logWarn(`Duplicated hotspot id \"${hotspot.id}`);\n            } else {\n                ids.push(hotspot.id);\n            }\n        });\n\n        this.config.hotspots = hotspots || [];\n\n        this.component.setHotspots(this.config.hotspots);\n    }\n\n    /**\n     * Removes all hotspots\n     */\n    clearHotspots() {\n        this.setHotspots(null);\n    }\n\n    /**\n     * Changes the highlighted hotspot\n     */\n    setActiveHotspot(hotspotId: string) {\n        this.component.setActiveHotspot(hotspotId);\n    }\n\n    /**\n     * Returns the Leaflet instance\n     */\n    getLeaflet(): Map {\n        return this.component.map;\n    }\n\n    private __markersToHotspots(markers: Marker[]): PlanHotspot[] {\n        return markers\n            .filter((marker) => marker.data?.[MARKER_DATA_KEY])\n            .map((marker) => {\n                const hotspot: PlanHotspot = {\n                    ...marker.data[MARKER_DATA_KEY],\n                    id: HOTSPOT_MARKER_ID + marker.id,\n                    tooltip: marker.config.tooltip,\n                };\n\n                if (!hotspot.coordinates) {\n                    utils.logWarn(`Marker #${marker.id} \"plan\" data is missing GPS coordinates`);\n                    return null;\n                }\n\n                return hotspot;\n            })\n            .filter((h) => h);\n    }\n}\n","import type { Position, Viewer } from '@photo-sphere-viewer/core';\nimport { AbstractComponent, CONSTANTS, utils } from '@photo-sphere-viewer/core';\nimport type { MarkersPlugin } from '@photo-sphere-viewer/markers-plugin';\nimport { Control, Layer, Map, Marker, TileLayer } from 'leaflet';\nimport { MathUtils } from 'three';\nimport type { PlanPlugin } from '../PlanPlugin';\nimport { HOTSPOT_MARKER_ID, OSM_ATTRIBUTION, OSM_LABEL, OSM_URL } from '../constants';\nimport { SelectHotspot } from '../events';\nimport { PlanHotspot } from '../model';\nimport { createLeafletIcon, getStyle, gpsToLeaflet } from '../utils';\nimport { PlanCloseButton } from './PlanCloseButton';\nimport { PlanLayersButton } from './PlanLayersButton';\nimport { PlanMaximizeButton } from './PlanMaximizeButton';\nimport { PlanResetButton } from './PlanResetButton';\n\nexport class PlanComponent extends AbstractComponent {\n    protected override readonly state = {\n        visible: false,\n        maximized: false,\n        collapsed: false,\n\n        layers: {} as Record<string, Layer>,\n        pinMarker: null as Marker,\n        hotspots: {} as Record<string, {\n            hotspot: PlanHotspot;\n            marker: Marker;\n            isMarker: boolean;\n        }>,\n        hotspotId: null as string,\n\n        forceRender: false,\n        needsUpdate: false,\n        renderLoop: null as ReturnType<typeof requestAnimationFrame>,\n    };\n\n    public readonly map: Map;\n    private readonly resetButton: PlanResetButton;\n    private readonly closeButton: PlanCloseButton;\n    private readonly maximizeButton: PlanMaximizeButton;\n    private readonly layersButton: PlanLayersButton;\n\n    get config() {\n        return this.plugin.config;\n    }\n\n    get maximized() {\n        return this.state.maximized;\n    }\n\n    get collapsed() {\n        return this.state.collapsed;\n    }\n\n    constructor(\n        viewer: Viewer,\n        private plugin: PlanPlugin\n    ) {\n        super(viewer, {\n            className: `psv-plan ${CONSTANTS.CAPTURE_EVENTS_CLASS}`,\n        });\n\n        const mapContainer = document.createElement('div');\n        mapContainer.className = 'psv-plan__container';\n\n        this.map = new Map(mapContainer, {\n            attributionControl: false,\n            zoomControl: false,\n        });\n        new Control.Attribution({ prefix: false }).addTo(this.map);\n\n        this.container.appendChild(mapContainer);\n\n        this.container.addEventListener('transitionstart', this);\n        this.container.addEventListener('transitionend', this);\n\n        // sub-components\n        this.layersButton = new PlanLayersButton(this);\n        if (this.config.buttons.reset) {\n            this.resetButton = new PlanResetButton(this);\n        }\n        if (this.config.buttons.maximize) {\n            this.maximizeButton = new PlanMaximizeButton(this);\n        }\n        if (this.config.buttons.close) {\n            this.closeButton = new PlanCloseButton(this);\n        }\n\n        // render loop\n        const renderLoop = () => {\n            if (this.isVisible() && (this.state.needsUpdate || this.state.forceRender)) {\n                this.map?.invalidateSize();\n                this.state.needsUpdate = false;\n            }\n            this.state.renderLoop = requestAnimationFrame(renderLoop);\n        };\n        renderLoop();\n\n        this.applyConfig();\n        this.hide();\n\n        if (!this.config.visibleOnLoad) {\n            this.toggleCollapse();\n        }\n\n        if (this.config.configureLeaflet) {\n            this.config.configureLeaflet(this.map);\n        } else {\n            this.state.layers = this.config.layers.reduce((acc, layer, i) => {\n                if (!layer.name) {\n                    layer.name = `Layer ${i+1}`;\n                }\n\n                if (layer.urlTemplate) {\n                    acc[layer.name] = new TileLayer(layer.urlTemplate, { attribution: layer.attribution });\n                } else if (layer.layer) {\n                    if (layer.attribution) {\n                        layer.layer.options.attribution = layer.attribution;\n                    }\n                    acc[layer.name] = layer.layer;\n                } else {\n                    utils.logWarn(`Layer #${i} is missing \"urlTemplate\" or \"layer\" property.`);\n                }\n                return acc;\n            }, {} as Record<string, Layer>);\n\n            if (!Object.values(this.state.layers).length) {\n                utils.logWarn(`No layer configured, fallback to OSM.`);\n                this.state.layers[OSM_LABEL] = new TileLayer(OSM_URL, { attribution: OSM_ATTRIBUTION });\n            }\n\n            const layersNames = Object.keys(this.state.layers);\n\n            this.setLayer(layersNames[0]);\n\n            if (layersNames.length > 1) {\n                this.layersButton.setLayers(layersNames);\n            }\n        }\n\n        this.map.fitWorld();\n\n        if (this.config.coordinates) {\n            this.recenter();\n        }\n    }\n\n    override destroy(): void {\n        cancelAnimationFrame(this.state.renderLoop);\n\n        super.destroy();\n    }\n\n    handleEvent(e: Event) {\n        if (utils.getClosest(e.target as HTMLElement, `.${CONSTANTS.CAPTURE_EVENTS_CLASS}:not(.psv-plan)`)) {\n            return;\n        }\n        switch (e.type) {\n            case 'transitionstart':\n                this.state.forceRender = true;\n                break;\n            case 'transitionend':\n                this.state.forceRender = false;\n                break;\n        }\n    }\n\n    applyConfig() {\n        this.container.classList.remove(\n            'psv-plan--top-right',\n            'psv-plan--top-left',\n            'psv-plan--bottom-right',\n            'psv-plan--bottom-left'\n        );\n        this.container.classList.add(`psv-plan--${this.config.position.join('-')}`);\n\n        this.container.style.width = this.config.size.width;\n        this.container.style.height = this.config.size.height;\n\n        this.layersButton.applyConfig();\n        this.resetButton?.applyConfig();\n        this.closeButton?.applyConfig();\n        this.maximizeButton?.applyConfig();\n\n        this.state.needsUpdate = true;\n    }\n\n    /**\n     * Force re-creation of the central pin\n     */\n    updatePin() {\n        if (this.state.pinMarker) {\n            this.state.pinMarker.remove();\n            this.state.pinMarker = null;\n        }\n        this.recenter();\n    }\n\n    /**\n     * Force re-creation of hotspots\n     */\n    updateSpots() {\n        this.setHotspots(Object.values(this.state.hotspots).filter(({ isMarker }) => !isMarker).map(({ hotspot }) => hotspot));\n        this.setMarkers(Object.values(this.state.hotspots).filter(({ isMarker }) => isMarker).map(({ hotspot }) => hotspot));\n    }\n\n    override isVisible(): boolean {\n        return this.state.visible && !this.state.collapsed;\n    }\n\n    override show() {\n        super.show();\n        this.state.needsUpdate = true;\n    }\n\n    override hide() {\n        super.hide();\n        this.state.forceRender = false;\n    }\n\n    /**\n     * Rotates the central pin\n     */\n    updateBearing(position: Position = this.viewer.getPosition()) {\n        if (this.state.pinMarker) {\n            const elt = this.state.pinMarker.getElement().firstElementChild as HTMLElement;\n            elt.style.rotate = MathUtils.radToDeg(position.yaw + this.config.bearing) + 'deg';\n        }\n    }\n\n    /**\n     * Changes the base layer\n     */\n    setLayer(name: string) {\n        Object.values(this.state.layers).forEach((layer) => {\n            if (this.map.hasLayer(layer)) {\n                this.map.removeLayer(layer);\n            }\n        });\n\n        this.map.addLayer(this.state.layers[name]);\n    }\n\n    /**\n     * Resets the map position and zoom level\n     */\n    reset() {\n        this.map.setView(gpsToLeaflet(this.config.coordinates), this.config.defaultZoom);\n    }\n\n    /**\n     * Moves the position pin and resets the map position\n     */\n    recenter() {\n        const pos = gpsToLeaflet(this.config.coordinates);\n\n        if (!this.state.pinMarker) {\n            const icon = createLeafletIcon(this.config.pinImage, this.config.pinSize, 'psv-plan__pin');\n\n            this.state.pinMarker = new Marker(pos, {\n                icon,\n                alt: '',\n            }).addTo(this.map);\n\n            this.updateBearing();\n        } else {\n            this.state.pinMarker.setLatLng(pos);\n        }\n\n        if (this.map.getZoom() < 10) {\n            this.reset();\n        } else {\n            this.map.setView(pos);\n        }\n    }\n\n    /**\n     * Switch collapsed mode\n     */\n    toggleCollapse() {\n        if (this.state.maximized) {\n            this.toggleMaximized();\n        }\n\n        this.state.collapsed = !this.state.collapsed;\n\n        utils.toggleClass(this.container, 'psv-plan--collapsed', this.state.collapsed);\n\n        if (!this.state.collapsed && this.map) {\n            this.reset();\n        }\n\n        this.closeButton?.update();\n    }\n\n    /**\n     * Switch maximized mode\n     */\n    toggleMaximized() {\n        if (this.state.collapsed) {\n            return;\n        }\n\n        this.state.maximized = !this.state.maximized;\n\n        utils.toggleClass(this.container, 'psv-plan--maximized', this.state.maximized);\n\n        this.maximizeButton?.update();\n    }\n\n    /**\n     * Changes the zoom level\n     */\n    zoom(d: number) {\n        this.map.setZoom(d);\n    }\n\n    /**\n     * Updates the markers\n     */\n    setMarkers(markers: PlanHotspot[]) {\n        this.__setHotspots(markers, true);\n    }\n\n    /**\n     * Changes the highlighted hotspot\n     */\n    setActiveHotspot(hotspotId: string) {\n        if (this.state.hotspotId) {\n            this.__applyStyle(this.state.hotspotId, false);\n        }\n\n        if (hotspotId) {\n            this.__applyStyle(hotspotId, true);\n        }\n\n        this.state.hotspotId = hotspotId;\n    }\n\n    /**\n     * Changes the hotspots\n     */\n    setHotspots(hotspots: PlanHotspot[]) {\n        this.__setHotspots(hotspots, false);\n    }\n\n    private __setHotspots(hotspots: PlanHotspot[], isMarkers: boolean) {\n        Object.entries(this.state.hotspots)\n            .filter(([, { isMarker }]) => isMarker === isMarkers)\n            .forEach(([id, { marker }]) => {\n                marker.off();\n                marker.remove();\n                delete this.state.hotspots[id];\n            });\n\n        hotspots.forEach((hotspot) => {\n            const style = getStyle(this.config.spotStyle, hotspot, false);\n\n            const icon = createLeafletIcon(style.image || '', style.size, 'psv-plan__spot');\n\n            const marker = new Marker(gpsToLeaflet(hotspot.coordinates), {\n                icon,\n                alt: '',\n            }).addTo(this.map);\n\n            if (hotspot.tooltip) {\n                if (typeof hotspot.tooltip === 'string') {\n                    hotspot.tooltip = { content: hotspot.tooltip };\n                }\n\n                marker.bindTooltip(hotspot.tooltip.content, {\n                    className: hotspot.tooltip.className,\n                    direction: 'top',\n                    offset: [0, -style.size / 2],\n                });\n            }\n\n            marker.on('click', () => this.__clickHotspot(hotspot.id));\n            marker.on('mouseover', () => this.setActiveHotspot(hotspot.id));\n            marker.on('mouseout', () => this.setActiveHotspot(null));\n\n            this.state.hotspots[hotspot.id] = {\n                hotspot,\n                marker,\n                isMarker: isMarkers,\n            };\n\n            this.__applyStyle(hotspot.id, false);\n        });\n    }\n\n    /**\n     * Updates the style of a map marker\n     */\n    private __applyStyle(hotspotId: string, hover: boolean) {\n        const hotspot = this.state.hotspots[hotspotId]?.hotspot;\n        const element = this.state.hotspots[hotspotId]?.marker.getElement();\n\n        if (!hotspot) {\n            return;\n        }\n\n        const style = getStyle(this.config.spotStyle, hotspot, hover);\n\n        element.style.width = style.size + 'px';\n        element.style.height = style.size + 'px';\n        element.style.marginTop = (-style.size / 2) + 'px';\n        element.style.marginLeft = (-style.size / 2) + 'px';\n\n        if (!style.image) {\n            element.style.backgroundColor = style.color;\n            element.style.outlineStyle = 'solid';\n            element.style.outlineColor = style.borderColor;\n            element.style.outlineWidth = style.borderSize + 'px';\n        } else {\n            (element.firstElementChild as HTMLImageElement).src = style.image;\n        }\n    }\n\n    /**\n     * Dispatch event when a hotspot is clicked\n     */\n    private __clickHotspot(hotspotId: string) {\n        this.plugin.dispatchEvent(new SelectHotspot(hotspotId));\n\n        if (hotspotId.startsWith(HOTSPOT_MARKER_ID)) {\n            const markerId = hotspotId.substring(HOTSPOT_MARKER_ID.length);\n            this.viewer.getPlugin<MarkersPlugin>('markers').gotoMarker(markerId);\n        }\n\n        if (this.maximized) {\n            this.toggleMaximized();\n        }\n    }\n\n}\n","export const OSM_LABEL = 'OpenStreetMap';\nexport const OSM_URL = 'https://tile.openstreetmap.org/{z}/{x}/{y}.png';\nexport const OSM_ATTRIBUTION = '&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a>';\n\nexport const MARKER_DATA_KEY = 'plan';\nexport const HOTSPOT_GENERATED_ID = '__generated__';\nexport const HOTSPOT_MARKER_ID = '__marker__';\n","import { DivIcon, LatLngLiteral } from 'leaflet';\nimport { GpsPosition, PlanHotspotStyle } from './model';\n\nexport function gpsToLeaflet(gps: GpsPosition): LatLngLiteral {\n    return { lng: gps[0], lat: gps[1], alt: gps[2] };\n}\n\nexport function createLeafletIcon(src: string, size: number, className: string): DivIcon {\n    return new DivIcon({\n        html: src && !src.includes('<svg')  ? `<img src=\"${src}\" style=\"width: 100%; height: 100%\">` : src,\n        iconSize: [size, size],\n        iconAnchor: [size / 2, size / 2],\n        className,\n    });\n}\n\nexport function getStyle(defaultStyle: PlanHotspotStyle, style: PlanHotspotStyle, isHover: boolean) {\n    return {\n        image: isHover\n            ? style.hoverImage ?? style.image ?? defaultStyle.hoverImage ?? defaultStyle.image\n            : style.image ?? defaultStyle.image,\n        size: isHover\n            ? style.hoverSize ?? style.size ?? defaultStyle.hoverSize ?? defaultStyle.size\n            : style.size ?? defaultStyle.size,\n        color: isHover\n            ? style.hoverColor ?? style.color ?? defaultStyle.hoverColor ?? defaultStyle.color\n            : style.color ?? defaultStyle.color,\n        borderColor: isHover\n            ? style.hoverBorderColor ?? defaultStyle.hoverBorderColor\n            : 'transparent',\n        borderSize: isHover\n            ? style.hoverBorderSize ?? defaultStyle.hoverBorderSize\n            : 0,\n    };\n}\n","import { CONSTANTS } from '@photo-sphere-viewer/core';\nimport icon from '../icons/map.svg';\nimport { AbstractPlanButton, ButtonPosition } from './AbstractPlanButton';\nimport type { PlanComponent } from './PlanComponent';\n\nexport class PlanCloseButton extends AbstractPlanButton {\n    constructor(plan: PlanComponent) {\n        super(plan, ButtonPosition.DEFAULT);\n\n        this.container.addEventListener('click', (e) => {\n            plan.toggleCollapse();\n            e.stopPropagation();\n        });\n    }\n\n    override applyConfig(): void {\n        super.applyConfig();\n        this.container.classList.add('psv-plan__button-close');\n    }\n\n    override update() {\n        this.container.innerHTML = this.plan.collapsed ? icon : CONSTANTS.ICONS.close;\n        this.container.title = this.plan.collapsed ? this.viewer.config.lang['map'] : this.viewer.config.lang.close;\n    }\n}\n","<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 32 32\" fill=\"currentColor\"><path d=\"M26.629,3.472c1.493,1.397,2.433,3.378,2.433,5.58c0,0.691-0.093,1.379-0.276,2.045c-0.076,0.273-0.166,0.541-0.271,0.8   l-0.201,0.458l-6.902,12.759l-7.11-13.235c-0.106-0.267-0.191-0.521-0.263-0.783c-0.184-0.663-0.277-1.351-0.277-2.044   c0-2.167,0.909-4.122,2.362-5.515l-4.956-3.195V5.05h-1V0.239L0,5.419V32l10.168-6.339V20.51h1v5.153l9.744,6.074v-4.897h1v4.812   L32,25.597V0L26.629,3.472z M11.168,17.732h-1v-3.564h1V17.732z M11.168,11.391h-1V7.827h1V11.391z\"/><circle cx=\"21.412\" cy=\"8.987\" r=\"2.664\"/><path d=\"M21.412,2.401c-3.667,0-6.65,2.983-6.65,6.65c0,0.603,0.081,1.202,0.241,1.778c0.062,0.227,0.137,0.449,0.222,0.665   l0.209,0.475l5.979,11.043l6.182-11.504c0.085-0.21,0.163-0.442,0.228-0.678c0.16-0.579,0.241-1.177,0.241-1.779   C28.062,5.385,25.079,2.401,21.412,2.401z M21.412,12.651c-2.021,0-3.664-1.644-3.664-3.664s1.644-3.664,3.664-3.664   s3.664,1.644,3.664,3.664S23.433,12.651,21.412,12.651z\"/><!-- Created by Icons By Alfredo from the Noun Project --></svg>\n","import { AbstractComponent } from '@photo-sphere-viewer/core';\nimport { PlanComponent } from './PlanComponent';\n\nexport const enum ButtonPosition {\n    DEFAULT,\n    DIAGONAL,\n    HORIZONTAL,\n    VERTICAL,\n}\n\nconst INVERT_POSITIONS: Record<string, string> = {\n    top: 'bottom',\n    bottom: 'top',\n    left: 'right',\n    right: 'left',\n};\n\nfunction getButtonPosition(mapPosition: [string, string], direction: ButtonPosition): [string, string] {\n    switch (direction) {\n        case ButtonPosition.DIAGONAL:\n            return [INVERT_POSITIONS[mapPosition[0]], INVERT_POSITIONS[mapPosition[1]]];\n        case ButtonPosition.HORIZONTAL:\n            return [mapPosition[0], INVERT_POSITIONS[mapPosition[1]]];\n        case ButtonPosition.VERTICAL:\n            return [INVERT_POSITIONS[mapPosition[0]], mapPosition[1]];\n        default:\n            return mapPosition;\n    }\n}\n\nexport abstract class AbstractPlanButton extends AbstractComponent {\n    constructor(\n        protected plan: PlanComponent,\n        private position: ButtonPosition\n    ) {\n        super(plan, {});\n    }\n\n    applyConfig() {\n        // prettier-ignore\n        this.container.className = `psv-plan__button psv-plan__button--${getButtonPosition(this.plan.config.position, this.position).join('-')}`;\n        this.update();\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    update() {}\n}\n","<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"20 20 60 60\" fill=\"currentColor\"><path d=\"M21.94,40.2,49.22,51.84a2,2,0,0,0,1.57,0L78.06,40.2a2,2,0,0,0,0-3.68L50.78,24.89a2,2,0,0,0-1.57,0L21.94,36.52a2,2,0,0,0,0,3.68Z\"/><path d=\"M76.49,59.8,50,71.1,23.51,59.8a2,2,0,0,0-1.57,3.68L49.22,75.11a2,2,0,0,0,1.57,0L78.06,63.48a2,2,0,0,0-1.57-3.68Z\"/><path d=\"M76.49,48.16,50,59.46,23.51,48.16a2,2,0,0,0-1.57,3.68L49.22,63.48a2,2,0,0,0,1.57,0L78.06,51.84a2,2,0,0,0-1.57-3.68Z\"/><!-- Created by Prithvi from the Noun Project --></svg>\n","import layersIcon from '../icons/layers.svg';\nimport { AbstractPlanButton, ButtonPosition } from './AbstractPlanButton';\nimport type { PlanComponent } from './PlanComponent';\n\nexport class PlanLayersButton extends AbstractPlanButton {\n\n    private select: HTMLSelectElement;\n\n    constructor(plan: PlanComponent) {\n        super(plan, ButtonPosition.VERTICAL);\n\n        const title = this.viewer.config.lang['mapLayers'];\n\n        this.container.title = title;\n        this.container.innerHTML = layersIcon;\n\n        this.select = document.createElement('select');\n        this.select.className = 'psv-plan__layers-select';\n        this.select.setAttribute('aria-label', title)\n\n        const placeholder = document.createElement('option');\n        placeholder.disabled = true;\n        placeholder.innerText = title;\n        this.select.appendChild(placeholder);\n\n        this.select.addEventListener('change', () => {\n            plan.setLayer(this.select.value);\n            this.__setSelected();\n        })\n\n        this.container.appendChild(this.select);\n\n        this.hide();\n    }\n\n    setLayers(layers: string[]) {\n        this.show();\n\n        layers.forEach((title) => {\n            const option = document.createElement('option');\n            option.value = title;\n            option.innerText = title;\n            this.select.appendChild(option);\n        });\n\n        this.select.value = layers[0];\n        this.__setSelected();\n    }\n\n    private __setSelected() {\n        this.select.querySelector<HTMLElement>('[selected]')?.removeAttribute('selected');\n        this.select.querySelector<HTMLElement>(`[value=\"${this.select.value}\"]`).setAttribute('selected', 'selected');\n    }\n}\n","<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\"><path d=\"M18 0h-6v2h6v6h2V0zM2 18v-6H0v8h8v-2z\"/><!-- Created by Stepan Voevodin from the Noun Project --></svg>\n","<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\"><path d=\"M14 6V0h-2v8h8V6zM0 12v2h6v6h2v-8H6z\"/><!-- Created by Stepan Voevodin from the Noun Project --></svg>\n","import maximize from '../icons/maximize.svg';\nimport minimize from '../icons/minimize.svg';\nimport { AbstractPlanButton, ButtonPosition } from './AbstractPlanButton';\nimport type { PlanComponent } from './PlanComponent';\n\nconst ROTATION: Record<string, number> = {\n    'bottom-left': 0,\n    'bottom-right': -90,\n    'top-right': 180,\n    'top-left': 90,\n};\n\nexport class PlanMaximizeButton extends AbstractPlanButton {\n    constructor(plan: PlanComponent) {\n        super(plan, ButtonPosition.DIAGONAL);\n\n        this.container.addEventListener('click', (e) => {\n            plan.toggleMaximized();\n            e.stopPropagation();\n        });\n    }\n\n    override update() {\n        this.container.innerHTML = this.plan.maximized ? minimize : maximize;\n        this.container.querySelector('svg').style.transform = `rotate3d(0, 0, 1, ${ROTATION[this.plan.config.position.join('-')]}deg)`;\n        this.container.title = this.plan.maximized\n            ? this.viewer.config.lang['mapMinimize']\n            : this.viewer.config.lang['mapMaximize'];\n    }\n}\n","<svg viewBox=\"170 100 360 360\" xmlns=\"http://www.w3.org/2000/svg\"><g fill=\"currentColor\"><path d=\"M518.6 269h-18.5a150.8 150.8 0 0 0-138-137.9v-20.9c0-5.8-4.7-10.6-10.5-10.6h-3.2c-5.8 0-10.6 4.8-10.6 10.6v21A150.8 150.8 0 0 0 200 269h-18.5c-5.9 0-10.6 4.7-10.6 10.6v3.2c0 5.8 4.7 10.5 10.6 10.5h18.5c6 73.4 64.6 132 138 138v18.5c0 5.8 4.7 10.6 10.5 10.6h3.2c5.8 0 10.6-4.8 10.6-10.6v-18.6c73.3-5.9 132-64.5 137.9-137.9h18.5c5.9 0 10.6-4.7 10.6-10.5v-3.2c0-5.9-4.7-10.6-10.6-10.6zM362.2 414.4v-9.8c0-5.9-4.8-10.6-10.6-10.6h-3.2c-5.8 0-10.6 4.7-10.6 10.6v9.8a134 134 0 0 1-121-121h9.8c5.9 0 10.6-4.8 10.6-10.6v-3.2c0-5.9-4.7-10.6-10.6-10.6h-9.8a134 134 0 0 1 121-121v7.5c0 5.8 4.8 10.5 10.6 10.5h3.2c5.8 0 10.6-4.7 10.6-10.5V148a134 134 0 0 1 121 121h-9.8c-5.9 0-10.6 4.7-10.6 10.6v3.2c0 5.8 4.7 10.5 10.6 10.5h9.8a134 134 0 0 1-121 121z\"/><path d=\"M355.4 222a6 6 0 0 0-10.7 0L291 320a8.3 8.3 0 0 0 9.7 12l39.2-11.7c6.6-2 13.6-2 20.2 0l39.2 11.7a8.3 8.3 0 0 0 9.7-12z\"/></g><!-- Created by muhammad benani from Noun Project --></svg>\n","import reset from '../icons/reset.svg';\nimport { AbstractPlanButton, ButtonPosition } from './AbstractPlanButton';\nimport type { PlanComponent } from './PlanComponent';\n\nexport class PlanResetButton extends AbstractPlanButton {\n    constructor(plan: PlanComponent) {\n        super(plan, ButtonPosition.HORIZONTAL);\n\n        this.container.title = this.viewer.config.lang['mapReset'];\n        this.container.innerHTML = reset;\n        this.container.querySelector('svg').style.width = '80%';\n\n        this.container.addEventListener('click', (e) => {\n            plan.reset();\n            e.stopPropagation();\n        });\n    }\n}\n","<svg viewBox=\"0 0 700 700\" xmlns=\"http://www.w3.org/2000/svg\">\n    <circle cx=\"350\" cy=\"350\" r=\"160\" fill=\"white\"/>\n    <circle cx=\"350\" cy=\"350\" r=\"120\" fill=\"#1E78E6\"/>\n    <path fill=\"rgba(255,255,255,0.8)\" d=\"M222,222 L103,103 A353,353,0,0,1,597,103 L478,222 A180,180,0,0,0,222,222\"/>\n</svg>\n"],"mappings":"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","names":["import_core","import_core","import_core","import_leaflet","import_core","import_core"]}